# מאמת תעודת זהות ישראלית

## הוראות

### שלב 1: זיהוי סוג המספר
| סוג | קידומת | אורך | דוגמה |
|-----|--------|------|-------|
| תעודת זהות | כלשהי | 9 ספרות | 123456782 |
| חברה (בע"מ) | 51 | 9 ספרות | 51-530820-1 |
| עמותה | 58 | 9 ספרות | 58-012345-6 |
| שותפות | 55 | 9 ספרות | 55-012345-6 |

### שלב 2: אימות באמצעות אלגוריתם ספרת ביקורת
אלגוריתם ספרת הביקורת של מספר זהות ישראלי (חל על כל הסוגים):

```python
def validate_israeli_id(id_number: str) -> bool:
    """Validate Israeli ID number (TZ, company, amuta, etc.)"""
    # Remove dashes and spaces, pad to 9 digits
    id_str = id_number.replace('-', '').replace(' ', '').zfill(9)

    if len(id_str) != 9 or not id_str.isdigit():
        return False

    total = 0
    for i, digit in enumerate(id_str):
        val = int(digit) * ((i % 2) + 1)  # Multiply by 1 or 2 alternately
        if val > 9:
            val = val // 10 + val % 10     # Sum digits if > 9
        total += val

    return total % 10 == 0
```

### שלב 3: מתן תוצאה
למספרים תקינים: אישור תקינות, זיהוי סוג לפי קידומת
למספרים לא תקינים: דיווח על אי-תקינות, הצגת הבדיקה שנכשלה, הצעת שגיאות נפוצות:
- ספרות מוחלפות
- ספרה חסרה/עודפת
- ספרת ביקורת שגויה

### שלב 4: יצירת מספרים לבדיקה (לשימוש בפיתוח)
לצורכי פיתוח ובדיקות, ניתן ליצור מספרי זיהוי תקינים:

```python
def generate_test_id(prefix: str = "") -> str:
    """Generate a valid Israeli ID number for testing."""
    import random
    base = prefix + ''.join([str(random.randint(0, 9)) for _ in range(8 - len(prefix))])
    # Calculate check digit
    total = 0
    for i, digit in enumerate(base):
        val = int(digit) * ((i % 2) + 1)
        if val > 9:
            val = val // 10 + val % 10
        total += val
    check = (10 - (total % 10)) % 10
    return base + str(check)
```

הערה חשובה: מספרים שנוצרו מיועדים לבדיקות בלבד. לעולם אל תשתמשו במספרים אקראיים כזיהוי אמיתי.

## דוגמאות

### דוגמה 1: אימות תעודת זהות
המשתמש אומר: "האם 123456782 הוא מספר תעודת זהות תקין?"
תוצאה: הרצת האלגוריתם, דיווח תקין/לא תקין עם הסבר.

### דוגמה 2: מימוש בקוד
המשתמש אומר: "אני צריך אימות תעודת זהות ישראלית ב-JavaScript"
תוצאה: מתן אלגוריתם מקביל ב-JavaScript.

### דוגמה 3: יצירת נתוני בדיקה
המשתמש אומר: "אני צריך 10 מספרי חברה תקינים לבדיקה"
תוצאה: יצירת 10 מספרים תקינים עם קידומת 51- לבדיקה.

## משאבים מצורפים

### סקריפטים
- `scripts/validate_id.py` — מאמת, מזהה, מעצב ומייצר מספרי זיהוי ישראליים (תעודת זהות, חברה, עמותה, שותפות). תומך במצב מפורט המציג חישוב ספרת ביקורת שלב אחר שלב, יצירת מספרי בדיקה באצווה עם בקרת קידומת, וזיהוי סוג מכל מספר. הרצה: `python scripts/validate_id.py --help`

### חומרי עזר
- `references/id-formats.md` — מפרט כל פורמטי מספרי הזיהוי הישראליים כולל תעודת זהות, חברה (קידומת 51), עמותה (קידומת 58), שותפות (קידומת 55), ואגודה שיתופית (קידומת 57) עם רשויות מנפיקות, תבניות פורמט, אלגוריתם ספרת ביקורת מסוג Luhn עם דוגמה מפורטת, ושגיאות אימות נפוצות. עיינו בו בעת מימוש לוגיקת אימות או דיבוג כשלים בספרת ביקורת.

## פתרון בעיות

### שגיאה: "המספר נראה תקין אך לא מזוהה"
סיבה: ספרת הביקורת עוברת אך המספר לא הונפק בפועל
פתרון: האלגוריתם מאמת רק את הפורמט, לא את הקיום בפועל. אימות האם מספר הונפק בפועל דורש גישה למערכות רשות המסים או משרד הפנים.
