# מפרמט טלפונים ישראלי

## הוראות

### שלב 1: זיהוי סוג מספר הטלפון

| סוג | קידומות | סה"כ ספרות | דוגמה (מקומי) |
|-----|---------|-----------|---------------|
| נייד | 050-058 | 10 | 052-1234567 |
| קווי | 02-04, 08-09 | 9 | 02-6251111 |
| VoIP | 072-077 | 10 | 077-1234567 |
| חינם | 1-800 | 10 | 1-800-123456 |
| פרימיום | 1-700 | 10 | 1-700-123456 |
| שירות כוכבית | *XXXX | 5-7 | *2421 |

לטבלת הקצאת הקידומות המלאה לפי ספק, עיינו ב-`references/prefix-allocation.md`.

### שלב 2: אימות המספר

הריצו `python scripts/validate_phone.py --number {input}` לאימות הפורמט וזיהוי הסוג.

אם מאמתים ידנית, יש ליישם את הכללים הבאים:
1. הסירו את כל הרווחים, המקפים והסוגריים
2. המירו קידומת בינלאומית: `+972` או `972` הופכים ל-`0` בהתחלה
3. התאימו לדפוסי קידומות מוכרים
4. ודאו ספירת ספרות (נייד/VoIP = 10, קווי = 9)

שגיאות אימות נפוצות:
- **ספירת ספרות שגויה**: מספרי נייד חייבים להכיל בדיוק 10 ספרות עם קידומת `0`
- **קידומת לא מוקצית**: `059` אינה מוקצית כרגע לאף ספק
- **חסר אפס מוביל**: מספרים מקומיים תמיד מתחילים ב-`0` (למעט חינם וכוכבית)

### שלב 3: עיצוב או המרה

**מקומי לבינלאומי:**
1. הסירו את ה-`0` המוביל
2. הוסיפו `+972` בהתחלה
3. דוגמה: `052-1234567` הופך ל-`+972-52-123-4567`

**בינלאומי למקומי:**
1. החליפו `+972` (או `972`) ב-`0`
2. דוגמה: `+972-2-625-1111` הופך ל-`02-6251111`

**חשוב:** מספרי חינם (1-800), פרימיום (1-700) ומספרי כוכבית (*) אינם ניתנים לחיוג בינלאומי.

### שלב 4: יצירת קוד

כשהמשתמש צריך אימות בקוד, ספקו פונקציה באמצעות דפוסי regex מתוך `references/prefix-allocation.md`. כללו:
- ניקוי קלט (הסרת תווי עיצוב)
- נרמול קידומת בינלאומית
- זיהוי סוג לפי קידומת
- אימות ספירת ספרות לפי סוג

## דוגמאות

### דוגמה 1: אימות מספר נייד
המשתמש אומר: "האם 052-1234567 הוא מספר טלפון ישראלי תקין?"
פעולות:
1. הסרת עיצוב: `0521234567`
2. התאמת קידומת `052` = נייד (סלקום)
3. אימות 10 ספרות בסך הכל
תוצאה: מספר נייד ישראלי תקין (סלקום). בינלאומי: +972-52-123-4567

### דוגמה 2: המרה לפורמט בינלאומי
המשתמש אומר: "המירו את 02-6251111 לפורמט בינלאומי"
פעולות:
1. הסרת עיצוב: `026251111`
2. התאמת קידומת `02` = קו קווי ירושלים
3. הסרת `0` מוביל, הוספת `+972`
תוצאה: +972-2-625-1111 (קו קווי ירושלים)

### דוגמה 3: אימות באצווה
המשתמש אומר: "אמתו את רשימת מספרי הטלפון הזו לייבוא ל-CRM שלי"
פעולות:
1. הרצת `python scripts/validate_phone.py --batch --input contacts.csv`
2. דיווח על ספירת תקינים/לא תקינים עם שגיאות ספציפיות לכל שורה
תוצאה: טבלת סיכום עם סטטוס אימות לכל מספר

## משאבים מצורפים

### סקריפטים
- `scripts/validate_phone.py` -- מאמת, מעצב וממיר מספרי טלפון ישראליים. תומך באימות מספר בודד, עיבוד CSV באצווה, והמרת פורמט בין מקומי לבינלאומי. הרצה: `python scripts/validate_phone.py --help`

### חומרי עזר
- `references/prefix-allocation.md` -- טבלת הקצאת קידומות טלפון ישראליות מלאה לפי משרד התקשורת, כולל הקצאות ספקים לקידומות ניידים (050-058), אזורי חיוג לקווים נייחים, טווחי VoIP, ומספרי שירותים מיוחדים. עיינו בה בעת מימוש אימות או זיהוי ספקים.

## פתרון בעיות

### שגיאה: "קידומת תקינה אך ספירת ספרות שגויה"
סיבה: בלבול בין אורך מספרי נייד (10 ספרות) לקווים נייחים (9 ספרות)
פתרון: מספרי נייד/VoIP תמיד מכילים 10 ספרות כולל ה-`0`. קווים נייחים מכילים 9. ספרו ספרות לאחר הסרת כל העיצוב.

### שגיאה: "המספר מתחיל ב-05 אך הקידומת לא מזוהה"
סיבה: לא כל קידומות 05X מוקצות. 059 אינה בשימוש כרגע.
פתרון: בדקו ב-`references/prefix-allocation.md` את ההקצאות הנוכחיות. קידומות נייד מוקצות: 050, 051, 052, 053, 054, 055, 056, 058.

### שגיאה: "לא ניתן להמיר מספר חינם לבינלאומי"
סיבה: מספרי 1-800 ו-1-700 הם מקומיים בלבד
פתרון: למספרים אלה אין מקבילה בינלאומית. אם המשתמש צריך נגישות בינלאומית, הציעו לספק מספר קווי או נייד רגיל במקום.
